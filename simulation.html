<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulation</title>

  <!-- Inter from Google Fonts -->
  <link
          href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
          rel="stylesheet"
  />

  <style>
    /* hide the native scrollbar */
    html {
      scrollbar-width: none; /* Firefox */
    }
    body::-webkit-scrollbar {
      display: none;         /* WebKit */
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      overflow-y: scroll;    /* enable scrolling, but invisible scrollbar */
    }

    .wrapper {
      position: relative;
    }

    /* Fixed simulator on the right */
    .simulator {
      position: fixed;
      top: 11rem;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      height: 60%;
      background: #ddd;
      z-index: 1;             /* so text is always above it */
      justify-content: center;
    }

    .simulator iframe {
      display: block;    /* eliminate any inline‐block whitespace */
      width: 100%;       /* fill container’s width */
      height: 100%;      /* fill container’s height */
      border: none;      /* optional: remove default border */
    }

    /* fixed vertical bar nav */
    aside {
      position: fixed;
      top: 50%;
      right: 2rem;
      transform: translateY(-50%);
    }
    nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    nav li.bar {
      width: 2px;
      height: 60px;
      background: #000;
      margin: 1rem 0;
      transition: width 0.2s;
      cursor: pointer;
    }
    nav li.bar.active {
      width: 8px;
    }

    /* each section fills the screen */
    section {
      position: relative;
      height: 100vh;
    }

    /* title+desc always in the same place */
    .text {
      position: absolute;
      top: 50px;       /* sits just above the simulator (which is at ~200px) */
      left: 5rem;
      right: 8rem;

      display: flex;
      align-items: center;
      flex-wrap: nowrap;
      overflow: hidden;

      opacity: 0;
      transform: translateY(100px);   /* tiny upward offset */
      transition:
              opacity 1s ease-out,
              transform 0.4s ease-out;

      z-index: 2;
    }
    /* fade-in of the active section */
    section.active .text {
      opacity: 1;
      transform: translateY(0);         /* <-- drop into natural spot */
    }

    /* clamp sizes so everything fits on one line */
    .text h2 {
      flex: none;
      font-size: clamp(50px, 8vw, 80px);
      margin: 0 1rem 0 0;
      line-height: 1;
    }

    .text p {
      flex: 1 1 auto;          /* take remaining space */
      font-size: clamp(14px, 1vw, 16px);
      margin: 0 0 0 2rem;
      line-height: 1.2;
      white-space: normal;     /* allow wrapping inside p */
      word-break: break-word;  /* prevent runaway words */
    }
  </style>
</head>
<body>
<div class="wrapper">
  <!-- your fixed simulator -->
  <div class="simulator">
    <iframe id="simulator-frame"
            src="hash_simulation.html"
            title="SHA-256 Simulator">
    </iframe>
  </div>
</div>

  <!-- the scrolling sections -->
<section id="hash" data-sim-src="hash_simulation.html" data-sim-title="SHA-256 Simulator">
  <div class="text">
    <h2>01 Hash</h2>
    <p>
      A hash is the fixed-length fingerprint of any input data, produced by a
      one-way cryptographic function (e.g. SHA-256). Even a tiny change yields
      a completely different output.
    </p>
  </div>
</section>

<section id="block" data-sim-src="block_simulation.html" data-sim-title="Block Construction Simulator">
  <div class="text">
    <h2>02 Block</h2>
    <p>
      A block bundles a batch of validated transactions (or data), plus the
      previous block’s hash, timestamp, and a nonce miners adjust to satisfy
      proof-of-work.
    </p>
  </div>
</section>

<section id="chain" data-sim-src="chain_simulation.html" data-sim-title="Chain Linking Simulator">
  <div class="text">
    <h2>03 Chain</h2>
    <p>
      Blocks link together via each block's reference to the previous block's hash,
      forming an immutable ledger.
    </p>
  </div>
</section>

<section id="network" data-sim-src="network_simulation.html" data-sim-title="Network Propagation Simulator">
  <div class="text">
    <h2>04 Network</h2>
    <p>
      Nodes broadcast new blocks and transactions to each other, ensuring everyone
      stays in consensus.
    </p>
  </div>
</section>

<section id="tokens" data-sim-src="token_simulation.html" data-sim-title="Tokens & Balance Simulator">
  <div class="text">
    <h2>05 Tokens</h2>
    <p>
      Tokens represent value. Balances update as transactions move tokens
      between addresses.
    </p>
  </div>
</section>

<section id="coinbase" data-sim-src="coinbase_simulation.html" data-sim-title="Coinbase Transaction Simulator">
  <div class="text">
    <h2>06 Coinbase</h2>
    <p>
      The coinbase transaction rewards the miner with new tokens for
      securing the network.
    </p>
  </div>
</section>

  <!-- fixed right-bar nav -->
  <aside>
    <nav>
      <ul>
        <li class="bar" data-target="hash"    aria-label="Hash"></li>
        <li class="bar" data-target="block"   aria-label="Block"></li>
        <li class="bar" data-target="chain"   aria-label="Blockchain"></li>
        <li class="bar" data-target="network" aria-label="Network"></li>
        <li class="bar" data-target="tokens"  aria-label="Tokens"></li>
        <li class="bar" data-target="coinbase"aria-label="Coinbase"></li>
      </ul>
    </nav>
  </aside>
</div>

<script>
  const simFrame = document.getElementById('simulator-frame');

  const opts = { root: null, threshold: 0.5 };
  const obs = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      const id = e.target.id;
      const bar = document.querySelector(`.bar[data-target="${id}"]`);
      if (e.isIntersecting) {
        e.target.classList.add('active');
        bar.classList.add('active');
        // Swap simulator iframe
        simFrame.src = e.target.dataset.simSrc;
        simFrame.title = e.target.dataset.simTitle;
      } else {
        e.target.classList.remove('active');
        bar.classList.remove('active');
      }
    });
  }, opts);

  document.querySelectorAll('section').forEach(s => obs.observe(s));

  // clicking a bar scrolls you to its section
  document.querySelectorAll('.bar').forEach(bar =>
          bar.addEventListener('click', () => {
            document
                    .getElementById(bar.dataset.target)
                    .scrollIntoView({ behavior: 'smooth' });
          })
  );
</script>
</body>
</html>
